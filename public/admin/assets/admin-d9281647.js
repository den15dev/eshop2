const S=document.querySelector(".page-tint"),r=200,q=document.querySelector("html"),_=window.matchMedia("(min-width: 992px)"),Z=window.matchMedia("(min-width: 576px)");document.querySelector('meta[name="csrf-token"]').content;const ee=document.documentElement.lang;let I;function te(){fetch("/admin/translations",{method:"get",headers:{Accept:"application/json"}}).then(e=>{if(!e.ok)throw new Error(`${e.status}`);return e.json()}).then(e=>{I=e}).catch(e=>{console.error("An error occurred while getting translations: "+e.message)})}function h(e,t,n){R(e)||ne(e,t,n)}function u(e,t,n){R(e)&&oe(e,t,n)}function F(e,t){t=`${t/1e3}s`,e.style.setProperty("--fade-speed",t)}function N(e){const t=getComputedStyle(e).getPropertyValue("opacity");e.style.setProperty("--max-opacity",t)}function R(e){return getComputedStyle(e).getPropertyValue("display")!=="none"}function ne(e,t,n){e.addEventListener("animationend",U,!1),F(e,t),N(e),e.style.display="block",e.classList.add("fade-in"),typeof n=="function"&&setTimeout(()=>n(),t+50)}function oe(e,t,n){e.addEventListener("animationend",D,!1),F(e,t),N(e),e.classList.add("fade-out"),typeof n=="function"&&setTimeout(()=>n(),t+50)}function U(e){e.target.classList.remove("fade-in"),e.target.removeEventListener("animationend",U,!1)}function D(e){e.target.classList.remove("fade-out"),e.target.style.display="none",e.target.removeEventListener("animationend",D,!1)}const H=100;let L=!1;function j(e){L&&E(),h(e.parentNode.querySelector(".dropdown-list"),H),e.dataset.opened="on",L=!0,document.addEventListener("click",z)}function g(e){u(e.parentNode.querySelector(".dropdown-list"),H),e.dataset.opened="off",document.removeEventListener("click",z)}function E(){document.querySelectorAll(".dropdown-btn").forEach(e=>{e.dataset.opened==="on"&&g(e)}),L=!1}function z(e){L&&!e.target.closest(".dropdown-btn, .dropdown-list")&&E()}function ce(){document.querySelectorAll(".dropdown-btn").forEach(e=>{e.addEventListener("click",()=>{e.dataset.opened==="on"?E():j(e)})})}function ie(e){e.forEach(t=>{t.addEventListener("click",()=>{t.dataset.opened==="on"?E():j(t)})})}function se(){document.querySelectorAll(".local-menu").forEach(e=>{const t=e.dataset.type,n=t.charAt(0).toUpperCase()+t.slice(1),o=e.querySelector(".dropdown-btn");e.querySelectorAll(".dropdown-list div").forEach(i=>{i.dataset.isCurrent?i.addEventListener("click",()=>{g(o)}):i.addEventListener("click",()=>{const l=i.dataset.itemId,w=document.querySelector(`#change${n}Form`);w.querySelector(`[name="new_${t}"]`).value=l,w.submit()})})})}const O=document.querySelector(".modal-tint"),v=document.querySelector("#flashModal"),s=document.querySelector("#clientModal"),d=s.querySelector("#clientOkBtn"),m=s.querySelector("#clientCancelBtn");function re(){document.querySelectorAll(".modal-close-btn").forEach(t=>{t.addEventListener("click",()=>{const n=t.closest(".modal-win");k(n)})}),d&&d.addEventListener("click",()=>{k(s)}),m&&m.addEventListener("click",()=>{k(s)}),v&&ae()}function k(e){u(e,r,()=>de(e)),u(O,r)}function le(e){V(e),h(O,r),h(e,r)}function ae(){V(v),O.style.display="block",v.style.display="block";const e=document.querySelector("#flashOkBtn");e.addEventListener("click",()=>{const t=e.closest(".modal-win");k(t)})}function V(e){const t=e.parentNode;t.style.display="flex"}function de(e){const t=e.parentNode;t.style.display="none"}function ue(e={}){const t=s.querySelector(".modal-icon.info"),n=s.querySelector(".modal-icon.success"),o=s.querySelector(".modal-icon.warning"),i=s.querySelector(".modal-icon.confirm");if(e.message){const l=s.querySelector("p");l.innerHTML=e.message}e.type==="confirm"&&(m.style.display="block",e.okAction&&(d.addEventListener("click",e.okAction),m.addEventListener("click",()=>{d.removeEventListener("click",e.okAction)}),d.closest(".modal-win").querySelector(".modal-close-btn").addEventListener("click",()=>{d.removeEventListener("click",e.okAction)})),e.cancelText&&(m.innerText=e.cancelText)),e.okText&&(d.innerText=e.okText),e.icon==="success"?n.style.display="block":e.icon==="warning"?o.style.display="block":e.icon==="confirm"?i.style.display="block":t.style.display="block",le(s)}function fe(e){ue({message:I.general.messages.error_occurred,icon:"warning"}),console.error(e)}const b=document.querySelector("ul.pagination");function me(){b&&Z.addEventListener("change",pe)}function pe(e){e.matches?b.classList.remove("pagination-sm"):b.classList.add("pagination-sm")}let p;function ye(e){p=e,p.forEach(t=>{var n;document.querySelector(t.container)&&(t.isOpened=!1,(Array.isArray(t.button)?t.button:[t.button]).forEach(i=>{var l;(l=document.querySelector(i))==null||l.addEventListener("click",function(){A(t)})}),(n=document.querySelector(t.container+" .bottom-menu_close-btn"))==null||n.addEventListener("click",function(){A(t)}))}),_.addEventListener("change",()=>{p.forEach(t=>{t.isOpened&&(x(t),u(S,r),J())})})}function A(e){e.isOpened?(x(e),u(S,r),J(),document.removeEventListener("click",$)):(p.forEach(t=>{t.isOpened&&(x(t),e.disablePageTint&&u(S,r))}),e.disablePageTint||h(S,r),h(document.querySelector(e.container),r),e.openActions(),e.isOpened=!0,he(),document.addEventListener("click",$))}function x(e){u(document.querySelector(e.container),r),e.closeActions(),e.isOpened=!1}function $(e){p.forEach(t=>{if(t.isOpened){let n=[t.container];Array.isArray(t.button)?t.button.forEach(i=>n.push(i)):n.push(t.button);let o=!1;n.forEach(i=>{!o&&e.target.closest(i)&&(o=!0)}),o||A(t)}})}function he(){!_.matches&&document.body.scrollHeight>window.innerHeight&&q.classList.add("noscroll-mobile")}function J(){q.classList.remove("noscroll-mobile"),q.removeAttribute("class")}const ge=[{button:"#headerMobileLeftBtn",container:"#headerLeftMenuCont",openActions(){document.querySelector(this.button).classList.add("opened")},closeActions(){document.querySelector(this.button).classList.remove("opened")}},{button:"#headerMobileRightBtn",container:"#headerRightMenuCont",openActions(){document.querySelector(this.button).classList.add("opened")},closeActions(){document.querySelector(this.button).classList.remove("opened")}}];function Se(){ye(ge)}const C=document.querySelector("#indexTableCont"),f=document.querySelector(".product-index_search-cont input"),ke=new URL(window.location.href),c=ke.searchParams;let M,P,y;function Le(){C&&(M=C.dataset.name,G(),K(),X(),Q()),f&&(f.addEventListener("input",Ee),y=f.parentNode.querySelector(".index-search_close-btn"),y.addEventListener("click",()=>{we(),y.classList.add("hidden")}))}function G(){const t=document.querySelector(".index-table_pref-cont").querySelector(".column-selector"),n=t.dataset.cookieName,o=t.querySelector(".dropdown-btn"),i=t.querySelector(".column-selector_apply-btn"),l=t.querySelector(".column-selector_close-btn");i.addEventListener("click",()=>{const Y=t.querySelector(".column-selector_list-cont").querySelectorAll(".column-selector_item input");let B=[];Y.forEach(T=>{T.checked&&B.push(T.dataset.index)}),W(n,B),a(),g(o)}),l.addEventListener("click",()=>{g(o)})}function K(){const e=document.querySelector(".index-table_per-page-dd");e.querySelectorAll(".dropdown-item").forEach(n=>{n.addEventListener("click",()=>{if(!n.classList.contains("active")){const i=parseInt(n.innerText,10);W("tbl_perpage",i),c.delete("page"),a()}const o=e.querySelector(".dropdown-btn");g(o)})})}function Q(){document.querySelectorAll(".pagination a.page-link").forEach(t=>{t.addEventListener("click",n=>{n.preventDefault();const o=new URL(t.href);c.set("page",o.searchParams.get("page")),a()})})}function Ee(){clearTimeout(P);let e=f.value;c.delete("page"),e.length?(P=setTimeout(function(){c.set("search",e),a()},300),y.classList.remove("hidden")):(c.delete("search"),a(),y.classList.add("hidden"))}function we(){f.value="",c.delete("search"),a(),f.focus()}function W(e,t){document.cookie=e+"="+encodeURIComponent(JSON.stringify(t))+"; path=/; max-age=157680000"}function a(){fetch(`/${ee}/admin/${M}/table?${c}`,{method:"get"}).then(e=>{if(!e.ok)throw new Error(`${e.status} (${e.statusText})`);return e.text()}).then(e=>{C.innerHTML=e;const t=document.querySelectorAll(".column-selector .dropdown-btn, .index-table_per-page-dd .dropdown-btn");ie(t),G(),K(),X(),Q(),qe()}).catch(e=>fe(e.message))}function qe(){const e=new URL(window.location.href);e.search="",c.forEach((t,n)=>{e.searchParams.set(n,t)}),window.history.pushState(null,"",e.toString())}function X(){document.querySelectorAll(".index-table_head-btn").forEach(t=>{t.addEventListener("click",()=>{const n=t.dataset.id,o=t.dataset.sortOrder;o==="desc"?(c.delete("sort"),c.delete("order")):o==="asc"?(c.set("sort",n),c.set("order","desc")):(c.set("sort",n),c.set("order","asc")),a()})})}function ve(){M==="products"&&(be(),Ae())}function be(){const e=document.querySelector(".product-index_category-cont select");e.addEventListener("change",()=>{e.value?c.set("category",e.value):c.has("category")&&c.delete("category"),c.delete("page"),a()})}function Ae(){const e=document.querySelectorAll(".product-index_checkboxes input");e.forEach(t=>{t.addEventListener("change",()=>{let n=!0;e.forEach(o=>{o.checked||(n=!1)}),n?e.forEach(o=>c.delete(o.name)):e.forEach(o=>c.set(o.name,o.checked)),c.delete("page"),a()})})}ce();re();me();Le();se();Se();ve();te();
